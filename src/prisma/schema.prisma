generator client {
    provider        = "prisma-client-js"
    previewFeatures = ["referentialIntegrity"]
}

datasource db {
    provider             = "mysql"
    url                  = env("DATABASE_URL")
    referentialIntegrity = "prisma"
}

model User {
    id        String   @id @default(cuid())
    name      String
    email     String   @unique
    password  String
    birthdate DateTime @db.Date

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    conversations Conversation[]

    @@map("users")
}

model Company {
    id                  String @id @default(cuid())
    name                String
    cnpj                String @unique
    email               String @unique
    phone               String
    password            String
    profile_picture_url String

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    address Address?

    conversations Conversation[]
    items         Item[]

    @@map("companies")
}

model Admin {
    id       String @id @default(cuid())
    name     String
    email    String @unique
    password String

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    @@map("admins")
}

model Address {
    id       String @id @default(cuid())
    street   String
    district String
    city     String
    uf       String
    cep      String
    number   String

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    company    Company @relation(fields: [company_id], references: [id])
    company_id String  @unique

    @@map("addresses")
}

model Item {
    id          String      @id @default(cuid())
    name        String
    color       String
    local       String
    description String
    images      ItemImage[]

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    company    Company? @relation(fields: [company_id], references: [id])
    company_id String?

    @@map("items")
}

model ItemImage {
    id        String @id @default(cuid())
    image_url String

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    item_id String
    item    Item   @relation(fields: [item_id], references: [id])

    @@map("item_images")
}

model Conversation {
    id String @id @default(cuid())

    user    User?   @relation(fields: [user_id], references: [id])
    user_id String?

    company    Company? @relation(fields: [company_id], references: [id])
    company_id String?

    messages Message[]

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    @@unique(fields: [user_id, company_id])
    @@map("conversations")
}

model Message {
    id String @id @default(cuid())

    content   String
    sender_id String

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    conversation    Conversation? @relation(fields: [conversation_id], references: [id])
    conversation_id String?

    @@map("messages")
}
